{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createResponsiveComponents = createResponsiveComponents;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? Object(arguments[i]) : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys.push.apply(ownKeys, Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar shallowEqual = function shallowEqual(a, b) {\n  for (var _key in a) {\n    if (a[_key] !== b[_key]) return false;\n  }\n\n  return true;\n};\n/** TODO */\n\n\nfunction createResponsiveComponents() {\n  var ResponsiveContext = _react.default.createContext({});\n\n  ResponsiveContext.displayName = \"Media.DynamicContext\";\n  var ResponsiveConsumer = ResponsiveContext.Consumer;\n  return {\n    Consumer: ResponsiveConsumer,\n    Provider: /*#__PURE__*/function (_React$Component) {\n      _inherits(ResponsiveProvider, _React$Component);\n\n      function ResponsiveProvider(props) {\n        var _this;\n\n        _classCallCheck(this, ResponsiveProvider);\n\n        _this = _possibleConstructorReturn(this, _getPrototypeOf(ResponsiveProvider).call(this, props));\n\n        _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"isSupportedEnvironment\", function () {\n          return typeof window !== \"undefined\" && typeof window.matchMedia !== \"undefined\";\n        });\n\n        _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"setupMatchers\", function (mediaQueries) {\n          return Object.keys(mediaQueries).reduce(function (matchers, key) {\n            return _objectSpread({}, matchers, _defineProperty({}, key, window.matchMedia(mediaQueries[key])));\n          }, {});\n        });\n\n        _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"checkMatchers\", function (mediaQueryMatchers) {\n          return Object.keys(mediaQueryMatchers).reduce(function (matches, key) {\n            return _objectSpread({}, matches, _defineProperty({}, key, mediaQueryMatchers[key].matches));\n          }, {});\n        });\n\n        _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"mediaQueryStatusChangedCallback\", function () {\n          var mediaQueryMatches = _this.checkMatchers(_this.state.mediaQueryMatchers);\n\n          _this.setState({\n            mediaQueryMatches: mediaQueryMatches\n          });\n        });\n\n        var _mediaQueryMatchers = undefined;\n\n        var _mediaQueryMatches;\n\n        if (_this.isSupportedEnvironment()) {\n          _mediaQueryMatchers = _this.setupMatchers(props.mediaQueries);\n          _mediaQueryMatches = _this.checkMatchers(_mediaQueryMatchers);\n        } else {\n          _mediaQueryMatches = Object.keys(props.mediaQueries).reduce(function (matches, key) {\n            return _objectSpread({}, matches, _defineProperty({}, key, !!props.initialMatchingMediaQueries && props.initialMatchingMediaQueries.includes(key)));\n          }, {});\n        }\n\n        _this.state = {\n          mediaQueryMatchers: _mediaQueryMatchers,\n          mediaQueryMatches: _mediaQueryMatches\n        };\n        return _this;\n      }\n\n      _createClass(ResponsiveProvider, [{\n        key: \"componentDidMount\",\n        // Lifecycle methods\n        value: function componentDidMount() {\n          if (this.state.mediaQueryMatchers) {\n            var mediaQueryStatusChangedCallback = this.mediaQueryStatusChangedCallback;\n            Object.values(this.state.mediaQueryMatchers).forEach(function (matcher) {\n              matcher.addListener(mediaQueryStatusChangedCallback);\n            });\n          }\n        }\n      }, {\n        key: \"componentWillUnmount\",\n        value: function componentWillUnmount() {\n          if (this.state.mediaQueryMatchers) {\n            var mediaQueryStatusChangedCallback = this.mediaQueryStatusChangedCallback;\n            Object.values(this.state.mediaQueryMatchers).forEach(function (matcher) {\n              return matcher.removeListener(mediaQueryStatusChangedCallback);\n            });\n          }\n        }\n      }, {\n        key: \"shouldComponentUpdate\",\n        value: function shouldComponentUpdate(nextProps, nextState) {\n          if (!this.state.mediaQueryMatchers) return false;\n          if (nextProps.children !== this.props.children) return true;\n\n          if (shallowEqual(this.state.mediaQueryMatches, nextState.mediaQueryMatches)) {\n            return false;\n          }\n\n          return true;\n        }\n      }, {\n        key: \"render\",\n        value: function render() {\n          return _react.default.createElement(ResponsiveContext.Provider, {\n            value: this.state.mediaQueryMatches\n          }, this.props.children);\n        }\n      }]);\n\n      return ResponsiveProvider;\n    }(_react.default.Component)\n  };\n}","map":{"version":3,"mappings":"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","names":["shallowEqual","a","b","key","createResponsiveComponents","ResponsiveContext","React","createContext","displayName","ResponsiveConsumer","Consumer","Provider","_inherits","props","_classCallCheck","_this","_defineProperty","window","matchMedia","mediaQueries","Object","keys","reduce","matchers","mediaQueryMatchers","matches","mediaQueryMatches","checkMatchers","state","setState","undefined","isSupportedEnvironment","setupMatchers","initialMatchingMediaQueries","includes","_createClass","value","mediaQueryStatusChangedCallback","values","forEach","matcher","addListener","removeListener","nextProps","nextState","children","_react","Component"],"sources":["../src/DynamicResponsive.tsx"],"sourcesContent":["/**\n * TODO: This is the deprecated runtime media-query component from Reaction.\n *       It can probably be simplified somewhat if weâ€™re not going to be using\n *       it directly any longer.\n */\n\nimport React from \"react\"\n\n/** TODO */\nexport type MediaQueries<M extends string = string> = { [K in M]: string }\n\n/** TODO */\nexport interface MediaQueryMatchers {\n  [key: string]: MediaQueryList\n}\n\n/** TODO */\nexport type MediaQueryMatches<M extends string = string> = { [K in M]: boolean }\n\n/** TODO */\nexport interface ResponsiveProviderProps<M extends string> {\n  mediaQueries: MediaQueries<M>\n  initialMatchingMediaQueries?: M[]\n  children: React.ReactNode\n}\n\n/** TODO */\nexport interface ResponsiveProviderState {\n  mediaQueryMatchers?: MediaQueryMatchers\n  mediaQueryMatches: MediaQueryMatches\n}\n\nconst shallowEqual = (a: MediaQueryMatches, b: MediaQueryMatches) => {\n  for (const key in a) {\n    if (a[key] !== b[key]) return false\n  }\n  return true\n}\n\n/** TODO */\nexport function createResponsiveComponents<M extends string>() {\n  const ResponsiveContext = React.createContext({})\n  ResponsiveContext.displayName = \"Media.DynamicContext\"\n\n  const ResponsiveConsumer: React.FunctionComponent<\n    React.ConsumerProps<MediaQueryMatches<M>>\n  > = ResponsiveContext.Consumer as React.FunctionComponent<\n    React.ConsumerProps<any>\n  >\n\n  return {\n    Consumer: ResponsiveConsumer,\n    Provider: class ResponsiveProvider extends React.Component<\n      ResponsiveProviderProps<M>,\n      ResponsiveProviderState\n    > {\n      constructor(props: ResponsiveProviderProps<M>) {\n        super(props)\n        let mediaQueryMatchers: MediaQueryMatchers | undefined = undefined\n        let mediaQueryMatches: MediaQueryMatches\n\n        if (this.isSupportedEnvironment()) {\n          mediaQueryMatchers = this.setupMatchers(props.mediaQueries)\n          mediaQueryMatches = this.checkMatchers(mediaQueryMatchers)\n        } else {\n          mediaQueryMatches = Object.keys(props.mediaQueries).reduce(\n            (matches, key) => ({\n              ...matches,\n              [key]:\n                !!props.initialMatchingMediaQueries &&\n                props.initialMatchingMediaQueries.includes(key as M),\n            }),\n            {}\n          )\n        }\n\n        this.state = {\n          mediaQueryMatchers,\n          mediaQueryMatches,\n        }\n      }\n\n      isSupportedEnvironment = () => {\n        return (\n          typeof window !== \"undefined\" &&\n          typeof window.matchMedia !== \"undefined\"\n        )\n      }\n\n      /**\n       * Create an array of media matchers that can validate each media query\n       */\n      setupMatchers = (mediaQueries: MediaQueries): MediaQueryMatchers => {\n        return Object.keys(mediaQueries).reduce(\n          (matchers, key) => ({\n            ...matchers,\n            [key]: window.matchMedia(mediaQueries[key]),\n          }),\n          {}\n        )\n      }\n\n      /**\n       * Uses the matchers to build a map of the states of each media query\n       */\n      checkMatchers = (\n        mediaQueryMatchers: MediaQueryMatchers\n      ): MediaQueryMatches => {\n        return Object.keys(mediaQueryMatchers).reduce(\n          (matches, key) => ({\n            ...matches,\n            [key]: mediaQueryMatchers[key].matches,\n          }),\n          {}\n        )\n      }\n\n      /**\n       * The function that will be called any time a media query status changes\n       */\n      mediaQueryStatusChangedCallback = () => {\n        const mediaQueryMatches = this.checkMatchers(\n          this.state.mediaQueryMatchers!\n        )\n        this.setState({\n          mediaQueryMatches,\n        })\n      }\n\n      // Lifecycle methods\n\n      componentDidMount() {\n        if (this.state.mediaQueryMatchers) {\n          const { mediaQueryStatusChangedCallback } = this\n          Object.values(this.state.mediaQueryMatchers).forEach(matcher => {\n            matcher.addListener(mediaQueryStatusChangedCallback)\n          })\n        }\n      }\n\n      componentWillUnmount() {\n        if (this.state.mediaQueryMatchers) {\n          const { mediaQueryStatusChangedCallback } = this\n          Object.values(this.state.mediaQueryMatchers).forEach(matcher =>\n            matcher.removeListener(mediaQueryStatusChangedCallback)\n          )\n        }\n      }\n\n      shouldComponentUpdate(\n        nextProps: Readonly<ResponsiveProviderProps<M>>,\n        nextState: Readonly<ResponsiveProviderState>\n      ) {\n        if (!this.state.mediaQueryMatchers) return false\n        if (nextProps.children !== this.props.children) return true\n        if (\n          shallowEqual(\n            this.state.mediaQueryMatches,\n            nextState.mediaQueryMatches\n          )\n        ) {\n          return false\n        }\n        return true\n      }\n\n      render() {\n        return (\n          <ResponsiveContext.Provider value={this.state.mediaQueryMatches}>\n            {this.props.children}\n          </ResponsiveContext.Provider>\n        )\n      }\n    },\n  }\n}\n"]},"metadata":{},"sourceType":"script"}